<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>uStepper S-lite: C:/Users/thomasolsen/Documents/Arduino/libraries/uStepper-S-lite/src/TMC2208.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">uStepper S-lite
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">TMC2208.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="TMC2208_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/********************************************************************************************</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">*       File:       TMC2208.h                                                               *</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">*       Version:    1.1.0                                                                   *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">*       Date:       June 14, 2020                                                           *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">*       Author:     Thomas Hørring Olsen                                                    *</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">*                                                                                           *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">*                                                                                           *   </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">*********************************************************************************************</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">*   (C) 2020                                                                                *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">*                                                                                           *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">*   uStepper ApS                                                                            *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">*   www.ustepper.com                                                                        *</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">*   administration@ustepper.com                                                             *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">*                                                                                           *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">*   The code contained in this file is released under the following open source license:    *</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">*                                                                                           *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">*           Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International         *</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">*                                                                                           *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">*   The code in this file is provided without warranty of any kind - use at own risk!       *</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">*   neither uStepper ApS nor the author, can be held responsible for any damage             *</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">*   caused by the use of the code contained in this file !                                  *</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">*                                                                                           *</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">********************************************************************************************/</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#ifndef TMC2208_H_</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#define TMC2208_H_</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">    #include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">    #include &lt;stdint.h&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">    #include &lt;avr/pgmspace.h&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">    #include &lt;Arduino.h&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">    #include &lt;util/delay.h&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">    #define R00 0x00000041</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">    #define R10 0x00001F00</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">    #define R6C 0x10000053</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">    #define R70 0xC10D0024</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// ===== TMC2208 &amp; 2202 &amp; TMC2208 &amp; 2220 &amp; 2225 &quot;Donkey Kong&quot; family register set =====</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">    #define TMC2208_GCONF         0x00</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">    #define TMC2208_GSTAT         0x01</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">    #define TMC2208_IFCNT         0x02</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">    #define TMC2208_SLAVECONF     0x03</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">    #define TMC2208_OTP_PROG      0x04</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">    #define TMC2208_OTP_READ      0x05</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">    #define TMC2208_IOIN          0x06</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">    #define TMC2208_FACTORY_CONF  0x07</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">    #define TMC2208_IHOLD_IRUN    0x10</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">    #define TMC2208_TPOWERDOWN    0x11</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">    #define TMC2208_TSTEP         0x12</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">    #define TMC2208_TPWMTHRS      0x13</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">    #define TMC2208_VACTUAL       0x22</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">    #define TMC2208_MSCNT         0x6A</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">    #define TMC2208_MSCURACT      0x6B</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">    #define TMC2208_CHOPCONF      0x6C</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">    #define TMC2208_DRVSTATUS     0x6F</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">    #define TMC2208_PWMCONF       0x70</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">    #define TMC2208_PWMSCALE      0x71</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_AUTO      0x72</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// Write-Bit</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">    #define TMC2208_WRITE_BIT 0x80</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">    #define TMC2208_I_SCALE_ANALOG_MASK          0x01 // GCONF // I_scale_analog  (Reset default=1)</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">    #define TMC2208_I_SCALE_ANALOG_SHIFT         0 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">    #define TMC2208_INTERNAL_RSENSE_MASK         0x02 // GCONF // internal_Rsense (Reset default: OTP)</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">    #define TMC2208_INTERNAL_RSENSE_SHIFT        1 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">    #define TMC2208_EN_SPREADCYCLE_MASK          0x04 // GCONF // en_spreadCycle (Reset default: OTP)</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">    #define TMC2208_EN_SPREADCYCLE_SHIFT         2 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">    #define TMC2208_SHAFT_MASK                   0x08 // GCONF // controls motor direction</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">    #define TMC2208_SHAFT_SHIFT                  3 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">    #define TMC2208_INDEX_OTPW_MASK              0x10 // GCONF // index_otpw</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">    #define TMC2208_INDEX_OTPW_SHIFT             4 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor">    #define TMC2208_INDEX_STEP_MASK              0x20 // GCONF // index_step</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">    #define TMC2208_INDEX_STEP_SHIFT             5 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">    #define TMC2208_PDN_DISABLE_MASK             0x40 // GCONF // pdn_disable</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">    #define TMC2208_PDN_DISABLE_SHIFT            6 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">    #define TMC2208_MSTEP_REG_SELECT_MASK        0x80 // GCONF // mstep_reg_select</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">    #define TMC2208_MSTEP_REG_SELECT_SHIFT       7 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">    #define TMC2208_MULTISTEP_FILT_MASK          0x0100 // GCONF // multistep_filt (Reset default=1)</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">    #define TMC2208_MULTISTEP_FILT_SHIFT         8 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">    #define TMC2208_TEST_MODE_MASK               0x0200 // GCONF // test_mode 0</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">    #define TMC2208_TEST_MODE_SHIFT              9 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">    #define TMC2208_RESET_MASK                   0x01 // GSTAT // reset</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">    #define TMC2208_RESET_SHIFT                  0 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">    #define TMC2208_DRV_ERR_MASK                 0x02 // GSTAT // drv_err</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">    #define TMC2208_DRV_ERR_SHIFT                1 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">    #define TMC2208_UV_CP_MASK                   0x04 // GSTAT // uv_cp</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">    #define TMC2208_UV_CP_SHIFT                  2 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">    #define TMC2208_IFCNT_MASK                   0xFF // IFCNT // Interface  transmission  counter.  This  register  becomes incremented  with  each successful UART  interface write access.  Read  out  to  check  the  serial  transmission  for lost  data.  Read  accesses  do  not  change  the  content. The counter wraps around from 255 to 0.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">    #define TMC2208_IFCNT_SHIFT                  0 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">    #define TMC2208_SLAVECONF_MASK               0x0F00 // SLAVECONF // SENDDELAY for read access (time until reply is sent): 0, 1:   8 bit times  2, 3:   3*8 bit times  4, 5:   5*8 bit times  6, 7:   7*8 bit times  8, 9:   9*8 bit times  10, 11:  11*8 bit times  12, 13:  13*8 bit times  14, 15:  15*8 bit times</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">    #define TMC2208_SLAVECONF_SHIFT              8 // min.: 0, max.: 15, default: 0</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">    #define TMC2208_OTPBIT_MASK                  0x07 // OTP_PROG // Selection of OTP bit to be programmed to the selected byte location (n=0..7: programs bit n to a logic 1)</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">    #define TMC2208_OTPBIT_SHIFT                 0 // min.: 0, max.: 7, default: 0</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">    #define TMC2208_OTPBYTE_MASK                 0x30 // OTP_PROG // Selection of OTP programming location (0, 1 or 2)</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">    #define TMC2208_OTPBYTE_SHIFT                4 // min.: 0, max.: 3, default: 0</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">    #define TMC2208_OTPMAGIC_MASK                0xFF00 // OTP_PROG // Set  to  0xBD  to  enable  programming.  A  programming time of  minimum 10ms per bit is  recommended (check by reading OTP_READ).</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">    #define TMC2208_OTPMAGIC_SHIFT               8 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">    #define TMC2208_OTP0_BYTE_0_READ_DATA_MASK   0x01 // OTP_READ // to be detailed</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">    #define TMC2208_OTP0_BYTE_0_READ_DATA_SHIFT  0 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">    #define TMC2208_OTP1_BYTE_1_READ_DATA_MASK   0x02 // OTP_READ // to be detailed</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">    #define TMC2208_OTP1_BYTE_1_READ_DATA_SHIFT  8 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">    #define TMC2208_OTP2_BYTE_2_READ_DATA_MASK   0x04 // OTP_READ // to be detailed</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">    #define TMC2208_OTP2_BYTE_2_READ_DATA_SHIFT  16 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">    #define TMC2208_ENN_MASK                     0x01 // IOIN // </span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor">    #define TMC2208_ENN_SHIFT                    0 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor">    #define TMC2208_MS1_MASK                     0x04 // IOIN // </span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">    #define TMC2208_MS1_SHIFT                    2 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">    #define TMC2208_MS2_MASK                     0x08 // IOIN // </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">    #define TMC2208_MS2_SHIFT                    3 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="preprocessor">    #define TMC2208_DIAG_MASK                    0x10 // IOIN // </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="preprocessor">    #define TMC2208_DIAG_SHIFT                   4 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">    #define TMC2208_PDN_UART_MASK                0x40 // IOIN // </span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">    #define TMC2208_PDN_UART_SHIFT               6 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">    #define TMC2208_STEP_MASK                    0x80 // IOIN // </span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">    #define TMC2208_STEP_SHIFT                   7 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">    #define TMC2208_SEL_A_MASK                   0x0100 // IOIN // Driver type</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="preprocessor">    #define TMC2208_SEL_A_SHIFT                  8 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor">    #define TMC2208_DIR_MASK                     0x0200 // IOIN // </span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="preprocessor">    #define TMC2208_DIR_SHIFT                    9 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="preprocessor">    #define TMC2208_VERSION_MASK                 0xFF000000 // IOIN // VERSION: 0x20=first version of the IC Identical numbers mean full digital compatibility.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">    #define TMC2208_VERSION_SHIFT                24 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor">    #define TMC2208_FCLKTRIM_MASK                0x1F // FACTORY_CONF // FCLKTRIM (Reset default: OTP)           0…31:  Lowest  to  highest  clock  frequency.  Check  at  charge  pump  output.  The  frequency  span  is  not  guaranteed,  but  it  is  tested,  that  tuning  to  12MHz  internal  clock  is  possible.  The  devices  come  preset  to  12MHz clock frequency by OTP programming.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">    #define TMC2208_FCLKTRIM_SHIFT               0 // min.: 0, max.: 31, default: 0</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">    #define TMC2208_OTTRIM_MASK                  0x30 // FACTORY_CONF // OTTRIM (Default: OTP) %00:   OT=143°C, OTPW=120°C %01:  OT=150°C, OTPW=120°C %10:  OT=150°C, OTPW=143°C %11:  OT=157°C, OTPW=143°C</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">    #define TMC2208_OTTRIM_SHIFT                 8 // min.: 0, max.: 3, default: 0</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">    #define TMC2208_IHOLD_MASK                   0x1F // IHOLD_IRUN // IHOLD (Reset default: OTP) Standstill current (0=1/32...31=32/32) In  combination  with  stealthChop  mode,  setting  IHOLD=0  allows  to  choose  freewheeling  or  coil  short circuit (passive braking) for motor stand still.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">    #define TMC2208_IHOLD_SHIFT                  0 // min.: 0, max.: 31, default: 0</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">    #define TMC2208_IRUN_MASK                    0x1F00 // IHOLD_IRUN // IRUN (Reset default=31) Motor run current (0=1/32...31=32/32) Hint:  Choose  sense  resistors  in  a  way,  that  normal  IRUN is 16 to 31 for best microstep performance.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">    #define TMC2208_IRUN_SHIFT                   8 // min.: 0, max.: 31, default: 0</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">    #define TMC2208_IHOLDDELAY_MASK              0x0F0000 // IHOLD_IRUN // IHOLDDELAY (Reset default: OTP) Controls  the  number  of  clock  cycles  for  motor  power down after standstill is detected (stst=1) and  TPOWERDOWN  has  expired.  The  smooth  transition  avoids a motor jerk upon power down. 0:   instant power down 1..15:   Delay per current reduction step in multiple  of 2^18 clocks</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">    #define TMC2208_IHOLDDELAY_SHIFT             16 // min.: 0, max.: 15, default: 0</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">    #define TMC2208_TPOWERDOWN_MASK              0xFF // TPOWERDOWN // (Reset default=20) Sets  the  delay  time  from  stand  still  (stst)  detection  to  motor current power down. Time range is about 0 to 5.6 seconds.  0...((2^8)-1) * 2^18 tclk Attention:  A  minimum  setting  of  2  is  required  to  allow automatic tuning of stealthChop PWM_OFFS_AUTO.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">    #define TMC2208_TPOWERDOWN_SHIFT             0 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">    #define TMC2208_TSTEP_MASK                   0x0FFFFF // TSTEP // Actual  measured  time  between  two  1/256  microsteps  derived  from  the  step  input  frequency  in  units  of  1/fCLK.  Measured  value is (2^20)-1 in case of overflow or stand still.  The  TSTEP  related  threshold  uses  a  hysteresis  of  1/16  of  the  compare value to compensate for jitter in the clock or the step  frequency:  (Txxx*15/16)-1  is  the  lower  compare  value  for  each  TSTEP based comparison. This  means,  that  the  lower  switching  velocity  equals  the  calculated setting, but the upper switching velocity is higher as  defined by the hysteresis setting.</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">    #define TMC2208_TSTEP_SHIFT                  0 // min.: 0, max.: 1048575, default: 0</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">    #define TMC2208_TPWMTHRS_MASK                0x0FFFFF // TPWMTHRS // Sets the upper velocity for stealthChop voltage PWM mode.          For TSTEP = TPWMTHRS, stealthChop PWM mode is enabled, if configured. When  the  velocity  exceeds  the  limit  set  by  TPWMTHRS,  the  driver switches to spreadCycle. 0 = Disabled</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">    #define TMC2208_TPWMTHRS_SHIFT               0 // min.: 0, max.: 1048575, default: 0</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">    #define TMC2208_VACTUAL_MASK                 0xFFFFFF // VACTUAL // VACTUAL allows moving the motor by UART control. It gives the motor velocity in +-(2^23)-1 [µsteps / t] 0: Normal operation. Driver reacts to STEP input. /=0:  Motor  moves  with  the  velocity  given  by  VACTUAL.  Step  pulses  can  be  monitored  via  INDEX  output.  The  motor  direction is controlled by the sign of VACTUAL.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">    #define TMC2208_VACTUAL_SHIFT                0 // min.: -8388608, max.: 8388607, default: 0</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">    #define TMC2208_MSCNT_MASK                   0x03FF // MSCNT // Microstep  counter.  Indicates  actual  position in the microstep table for  CUR_A.  CUR_B  uses an  offset  of  256  into  the  table.  Reading  out MSCNT  allows  determination  of  the  motor position within the electrical wave.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">    #define TMC2208_MSCNT_SHIFT                  0 // min.: 0, max.: 1023, default: 0</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">    #define TMC2208_CUR_A_MASK                   0x01FF // MSCURACT // (signed) Actual  microstep current for motor phase  A  as  read  from  the internal  sine  wave  table  (not scaled by current setting)</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">    #define TMC2208_CUR_A_SHIFT                  0 // min.: -255, max.: 255, default: 0</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">    #define TMC2208_CUR_B_MASK                   0x01FF0000 // MSCURACT // (signed) Actual  microstep current for motor phase  B  as  read  from  the internal  sine  wave  table  (not scaled by current setting)</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">    #define TMC2208_CUR_B_SHIFT                  16 // min.: -255, max.: 255, default: 0</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">    #define TMC2208_TOFF_MASK                    0x0F // CHOPCONF // chopper off time and driver enable, Off time setting controls duration of slow decay phase (Nclk = 12 + 32*Toff),  %0000: Driver disable, all bridges off %0001: 1 – use only with TBL = 2 %0010 ... %1111: 2 … 15 (Default: OTP, resp. 3 in stealthChop mode)</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">    #define TMC2208_TOFF_SHIFT                   0 // min.: 0, max.: 7, default: 0</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">    #define TMC2208_HSTRT_MASK                   0x70 // CHOPCONF // hysteresis start value added to HEND, %000 … %111: Add 1, 2, …, 8 to hysteresis low value HEND (1/512 of this setting adds to current setting) Attention: Effective HEND+HSTRT = 16. Hint: Hysteresis decrement is done each 16 clocks. (Default: OTP, resp. 0 in stealthChop mode)</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">    #define TMC2208_HSTRT_SHIFT                  4 // min.: 0, max.: 7, default: 0</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">    #define TMC2208_HEND_MASK                    0x0780 // CHOPCONF // hysteresis low value OFFSET sine wave offset, %0000 … %1111: Hysteresis is -3, -2, -1, 0, 1, …, 12 (1/512 of this setting adds to current setting) This is the hysteresis value which becomes used for the hysteresis chopper. (Default: OTP, resp. 5 in stealthChop mode)</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="preprocessor">    #define TMC2208_HEND_SHIFT                   7 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">    #define TMC2208_TBL_MASK                     0x018000 // CHOPCONF // blank time select, %00 … %11: Set comparator blank time to 16, 24, 32 or 40 clocks Hint: %00 or %01 is recommended for most applications (Default: OTP)</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">    #define TMC2208_TBL_SHIFT                    15 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">    #define TMC2208_VSENSE_MASK                  0x020000 // CHOPCONF // sense resistor voltage based current scaling</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">    #define TMC2208_VSENSE_SHIFT                 17 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">    #define TMC2208_MRES_MASK                    0x0F000000 // CHOPCONF // MRES micro step resolution,          %0000: Native 256 microstep setting.          %0001 … %1000: 128, 64, 32, 16, 8, 4, 2, FULLSTEP: Reduced microstep resolution.  The  resolution  gives  the  number  of  microstep  entries  per sine quarter wave. When  choosing  a  lower  microstep  resolution,  the  driver automatically  uses  microstep  positions  which  result  in  a symmetrical wave. Number of microsteps per step pulse = 2^MRES (Selection  by  pins  unless  disabled  by  GCONF. mstep_reg_select)</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">    #define TMC2208_MRES_SHIFT                   24 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">    #define TMC2208_INTPOL_MASK                  0x10000000 // CHOPCONF // interpolation to 256 microsteps</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor">    #define TMC2208_INTPOL_SHIFT                 28 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">    #define TMC2208_DEDGE_MASK                   0x20000000 // CHOPCONF // enable double edge step pulses</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor">    #define TMC2208_DEDGE_SHIFT                  29 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="preprocessor">    #define TMC2208_DISS2G_MASK                  0x40000000 // CHOPCONF // short to GND protection disable</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">    #define TMC2208_DISS2G_SHIFT                 30 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">    #define TMC2208_DISS2VS_MASK                 0x80000000 // CHOPCONF // Low side short protection disable</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">    #define TMC2208_DISS2VS_SHIFT                31 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">    #define TMC2208_OTPW_MASK                    0x01 // DRV_STATUS // overtemperature prewarning flag</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">    #define TMC2208_OTPW_SHIFT                   0 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">    #define TMC2208_OT_MASK                      0x02 // DRV_STATUS // overtemperature flag</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">    #define TMC2208_OT_SHIFT                     1 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">    #define TMC2208_S2GA_MASK                    0x04 // DRV_STATUS // short to ground indicator phase A</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor">    #define TMC2208_S2GA_SHIFT                   2 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">    #define TMC2208_S2GB_MASK                    0x08 // DRV_STATUS // short to ground indicator phase B</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">    #define TMC2208_S2GB_SHIFT                   3 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">    #define TMC2208_S2VSA_MASK                   0x10 // DRV_STATUS // low side short indicator phase A</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">    #define TMC2208_S2VSA_SHIFT                  4 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="preprocessor">    #define TMC2208_S2VSB_MASK                   0x20 // DRV_STATUS // low side short indicator phase B</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">    #define TMC2208_S2VSB_SHIFT                  5 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">    #define TMC2208_OLA_MASK                     0x40 // DRV_STATUS // open load indicator phase A</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="preprocessor">    #define TMC2208_OLA_SHIFT                    6 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">    #define TMC2208_OLB_MASK                     0x80 // DRV_STATUS // open load indicator phase B</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">    #define TMC2208_OLB_SHIFT                    7 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">    #define TMC2208_T120_MASK                    0x0100 // DRV_STATUS // 120°C comparator</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor">    #define TMC2208_T120_SHIFT                   8 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor">    #define TMC2208_T143_MASK                    0x0200 // DRV_STATUS // 143°C comparator</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="preprocessor">    #define TMC2208_T143_SHIFT                   9 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">    #define TMC2208_T150_MASK                    0x0400 // DRV_STATUS // 150°C comparator</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="preprocessor">    #define TMC2208_T150_SHIFT                   10 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">    #define TMC2208_T157_MASK                    0x0800 // DRV_STATUS // 157°C comparator</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor">    #define TMC2208_T157_SHIFT                   11 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">    #define TMC2208_CS_ACTUAL_MASK               0x1F0000 // DRV_STATUS // actual motor current</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">    #define TMC2208_CS_ACTUAL_SHIFT              16 // min.: 0, max.: 31, default: 0</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">    #define TMC2208_STEALTH_MASK                 0x40000000 // DRV_STATUS // stealthChop indicator</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">    #define TMC2208_STEALTH_SHIFT                30 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">    #define TMC2208_STST_MASK                    0x80000000 // DRV_STATUS // standstill indicator</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor">    #define TMC2208_STST_SHIFT                   31 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_OFS_MASK                 0xFF // PWMCONF // User defined PWM amplitude offset (0-255) related to full motor current (CS_ACTUAL=31) in stand still. (Reset default=36) When  using  automatic  scaling  (pwm_autoscale=1)  the  value  is  used  for  initialization,  only.  The  autoscale  function  starts  with  PWM_SCALE_AUTO=PWM_OFS  and finds  the  required  offset  to  yield  the  target  current  automatically. PWM_OFS  =  0  will  disable  scaling  down  motor  current below  a  motor  specific  lower  measurement  threshold. This  setting  should  only  be  used  under  certain  conditions, i.e.  when the power supply voltage can vary  up  and  down  by  a  factor  of  two  or  more.  It  prevents the  motor  going  out  of  regulation,  but  it  also  prevents  power down below the regulation limit. PWM_OFS &gt; 0 allows automatic scaling to low PWM duty  cycles  even  below  the  lower  regulation  threshold.  This  allows  low  (standstill)  current  settings  based  on  the  actual (hold) current scale (register IHOLD_IRUN). </span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_OFS_SHIFT                0 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_GRAD_MASK                0xFF00 // PWMCONF // Velocity dependent gradient for PWM amplitude:  PWM_GRAD * 256 / TSTEP This  value  is  added  to  PWM_AMPL  to  compensate  for  the velocity-dependent motor back-EMF.  With  automatic  scaling  (pwm_autoscale=1)  the  value  is  used  for  first  initialization,  only.  Set  PWM_GRAD  to  the  application  specific  value  (it  can  be  read  out  from  PWM_GRAD_AUTO)  to  speed  up  the  automatic  tuning  process.  An  approximate  value can be stored to  OTP  by  programming OTP_PWM_GRAD.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_GRAD_SHIFT               8 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_FREQ_MASK                0x030000 // PWMCONF // %00:   fPWM=2/1024 fCLK          %01:   fPWM=2/683 fCLK          %10:   fPWM=2/512 fCLK          %11:   fPWM=2/410 fCLK</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_FREQ_SHIFT               16 // min.: 0, max.: 3, default: 0</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_AUTOSCALE_MASK           0x040000 // PWMCONF // </span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_AUTOSCALE_SHIFT          18 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_AUTOGRAD_MASK            0x080000 // PWMCONF // </span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_AUTOGRAD_SHIFT           19 // min.: 0, max.: 1, default: 0</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">    #define TMC2208_FREEWHEEL_MASK               0x300000 // PWMCONF // Stand still option when motor current setting is zero (I_HOLD=0).  %00:   Normal operation %01:   Freewheeling %10:   Coil shorted using LS drivers %11:   Coil shorted using HS drivers</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">    #define TMC2208_FREEWHEEL_SHIFT              20 // min.: 0, max.: 3, default: 0</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_REG_MASK                 0x0F000000 // PWMCONF // User defined  maximum  PWM amplitude  change per  half  wave when using pwm_autoscale=1. (1...15): 1: 0.5 increments (slowest regulation) 2: 1 increment (default with OTP2.1=1) 3: 1.5 increments 4: 2 increments ... 8: 4 increments (default with OTP2.1=0) ...  15: 7.5 increments (fastest regulation)</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_REG_SHIFT                24 // min.: 0, max.: 25, default: 0</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_LIM_MASK                 0xF0000000 // PWMCONF // Limit  for  PWM_SCALE_AUTO  when  switching  back  from  spreadCycle to stealthChop. This value defines  the upper  limit  for  bits  7  to  4  of  the  automatic  current  control  when switching back. It can be set to reduce the current  jerk during mode change back to stealthChop. It does not limit PWM_GRAD or PWM_GRAD_AUTO offset. (Default = 12)</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_LIM_SHIFT                28 // min.: 0, max.: 15, default: 0</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_SCALE_SUM_MASK           0xFF // PWM_SCALE // Actual  PWM  duty  cycle.  This value  is  used  for  scaling  the values  CUR_A  and  CUR_B  read from the sine wave table.</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_SCALE_SUM_SHIFT          0 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_SCALE_AUTO_MASK          0x01FF0000 // PWM_SCALE // 9 Bit signed offset added to the calculated  PWM  duty  cycle.  This is  the  result  of  the  automatic amplitude  regulation  based  on current measurement.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_SCALE_AUTO_SHIFT         16 // min.: -255, max.: 255, default: 0</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_OFS_AUTO_MASK            0xFF // PWM_AUTO // Automatically  determined  offset value</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_OFS_AUTO_SHIFT           0 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_GRAD_AUTO_MASK           0xFF0000 // PWM_AUTO // Automatically  determined gradient value</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="preprocessor">    #define TMC2208_PWM_GRAD_AUTO_SHIFT          16 // min.: 0, max.: 255, default: 0</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">    #define ARRAY_SIZE(x) (sizeof(x)/sizeof(x[0]))</span></div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="TMC2208_8h.html#a6242a25f9d996f0cc4f4cdb911218b75">  250</a></span>&#160;    </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">    #define UARTTXPORT PORTC</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">    #define UARTTXDDR DDRC</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">    #define UARTTXPIN 3</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor">    #define UARTRXPORT PORTC</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor">    #define UARTRXDDR DDRC</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">    #define UARTRXPIN 2</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">    #define NORMALDIRECTION 0</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="preprocessor">    #define INVERSEDIRECTION 1</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// 2us delay (30 nops @ 62.5ns = 1.875us + C overhead ~ 2us) 500k baud</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"></span><span class="preprocessor">    #define UARTCLKDELAY()  __asm__ volatile (  &quot;nop \n\t&quot; &quot;nop \n\t&quot; &quot;nop \n\t&quot; &quot;nop \n\t&quot; &quot;nop \n\t&quot; &quot;nop \n\t&quot; &quot;nop \n\t&quot; &quot;nop \n\t&quot; &quot;nop \n\t&quot; &quot;nop \n\t&quot; &quot;nop \n\t&quot; &quot;nop \n\t&quot; )</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="classTmc2208.html">  277</a></span>&#160;<span class="keyword">class </span><a class="code" href="classTmc2208.html">Tmc2208</a></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;{</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="classTmc2208.html#aee6f58d366f4603b73629dc04d53400a">Tmc2208</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classTmc2208.html#a325a92257b38336e9ef6df12fcd4d552">setup</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classTmc2208.html#af81bbf175de574f64f3f49f91a822705">disableDriver</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classTmc2208.html#a648e00eda3d756b154a7d62572d5c12d">enableDriver</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classTmc2208.html#a4b06e13fd845a3973324acfcdbed1c38">setCurrent</a>(uint8_t runPercent, uint8_t holdPercent);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classTmc2208.html#a357f3feef7327c7c12cb6af33466e4ce">setHoldCurrent</a>(uint8_t holdPercent);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classTmc2208.html#af06fd0ce5ab19d219c30cb10dd5d69b7">setRunCurrent</a>(uint8_t runPercent);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classTmc2208.html#a713c10d6a967323926e83e63d919ca13">setVelocity</a>(<span class="keywordtype">float</span> RPM);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classTmc2208.html#a1576b8921751c68fff4a161453c99223">invertDirection</a>(<span class="keywordtype">bool</span> normal = INVERSEDIRECTION);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordtype">float</span> getRunCurrent(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordtype">float</span> getHoldCurrent(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="classTmc2208.html#ae0b976013d1eefbccb162e06b9c8393b">  372</a></span>&#160;    uint8_t <a class="code" href="classTmc2208.html#ae0b976013d1eefbccb162e06b9c8393b">runCurrent</a>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="classTmc2208.html#a11d520e001e90c89c6dc2f4fa9cf2d09">  376</a></span>&#160;    uint8_t <a class="code" href="classTmc2208.html#a11d520e001e90c89c6dc2f4fa9cf2d09">holdCurrent</a>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordtype">void</span> writeRegister(uint8_t address, int32_t value);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">void</span> readRegister(uint8_t address, int32_t *value);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    uint8_t calcCRC(uint8_t datagram[], uint8_t len);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordtype">void</span> uartInit(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordtype">void</span> uartSendByte(uint8_t value);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordtype">bool</span> uartReceivePacket(uint8_t *packet __attribute__((unused)), uint8_t size __attribute__((unused)));</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;};</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassTmc2208_html_a1576b8921751c68fff4a161453c99223"><div class="ttname"><a href="classTmc2208.html#a1576b8921751c68fff4a161453c99223">Tmc2208::invertDirection</a></div><div class="ttdeci">void invertDirection(bool normal=INVERSEDIRECTION)</div><div class="ttdoc">Invert motor direction.</div><div class="ttdef"><b>Definition:</b> <a href="TMC2208_8cpp_source.html#l00133">TMC2208.cpp:133</a></div></div>
<div class="ttc" id="aclassTmc2208_html_a4b06e13fd845a3973324acfcdbed1c38"><div class="ttname"><a href="classTmc2208.html#a4b06e13fd845a3973324acfcdbed1c38">Tmc2208::setCurrent</a></div><div class="ttdeci">void setCurrent(uint8_t runPercent, uint8_t holdPercent)</div><div class="ttdoc">Change run and hold current settings of the stepper motor driver - TMC2208.</div><div class="ttdef"><b>Definition:</b> <a href="TMC2208_8cpp_source.html#l00196">TMC2208.cpp:196</a></div></div>
<div class="ttc" id="aclassTmc2208_html_a713c10d6a967323926e83e63d919ca13"><div class="ttname"><a href="classTmc2208.html#a713c10d6a967323926e83e63d919ca13">Tmc2208::setVelocity</a></div><div class="ttdeci">void setVelocity(float RPM)</div><div class="ttdoc">Set motor velocity in RPM.</div><div class="ttdef"><b>Definition:</b> <a href="TMC2208_8cpp_source.html#l00228">TMC2208.cpp:228</a></div></div>
<div class="ttc" id="aclassTmc2208_html_a325a92257b38336e9ef6df12fcd4d552"><div class="ttname"><a href="classTmc2208.html#a325a92257b38336e9ef6df12fcd4d552">Tmc2208::setup</a></div><div class="ttdeci">void setup(void)</div><div class="ttdoc">Initializes the different parts of the TMC2208 object.</div><div class="ttdef"><b>Definition:</b> <a href="TMC2208_8cpp_source.html#l00114">TMC2208.cpp:114</a></div></div>
<div class="ttc" id="aclassTmc2208_html_a357f3feef7327c7c12cb6af33466e4ce"><div class="ttname"><a href="classTmc2208.html#a357f3feef7327c7c12cb6af33466e4ce">Tmc2208::setHoldCurrent</a></div><div class="ttdeci">void setHoldCurrent(uint8_t holdPercent)</div><div class="ttdoc">Change hold current setting of the stepper motor driver - TMC2208.</div><div class="ttdef"><b>Definition:</b> <a href="TMC2208_8cpp_source.html#l00215">TMC2208.cpp:215</a></div></div>
<div class="ttc" id="aclassTmc2208_html_ae0b976013d1eefbccb162e06b9c8393b"><div class="ttname"><a href="classTmc2208.html#ae0b976013d1eefbccb162e06b9c8393b">Tmc2208::runCurrent</a></div><div class="ttdeci">uint8_t runCurrent</div><div class="ttdef"><b>Definition:</b> <a href="TMC2208_8h_source.html#l00372">TMC2208.h:372</a></div></div>
<div class="ttc" id="aclassTmc2208_html_af81bbf175de574f64f3f49f91a822705"><div class="ttname"><a href="classTmc2208.html#af81bbf175de574f64f3f49f91a822705">Tmc2208::disableDriver</a></div><div class="ttdeci">void disableDriver(void)</div><div class="ttdoc">Disable the stepper motor driver - TMC2208.</div><div class="ttdef"><b>Definition:</b> <a href="TMC2208_8cpp_source.html#l00155">TMC2208.cpp:155</a></div></div>
<div class="ttc" id="aclassTmc2208_html_a648e00eda3d756b154a7d62572d5c12d"><div class="ttname"><a href="classTmc2208.html#a648e00eda3d756b154a7d62572d5c12d">Tmc2208::enableDriver</a></div><div class="ttdeci">void enableDriver(void)</div><div class="ttdoc">Enable the stepper motor driver - TMC2208.</div><div class="ttdef"><b>Definition:</b> <a href="TMC2208_8cpp_source.html#l00150">TMC2208.cpp:150</a></div></div>
<div class="ttc" id="aclassTmc2208_html_af06fd0ce5ab19d219c30cb10dd5d69b7"><div class="ttname"><a href="classTmc2208.html#af06fd0ce5ab19d219c30cb10dd5d69b7">Tmc2208::setRunCurrent</a></div><div class="ttdeci">void setRunCurrent(uint8_t runPercent)</div><div class="ttdoc">Change run current setting of the stepper motor driver - TMC2208.</div><div class="ttdef"><b>Definition:</b> <a href="TMC2208_8cpp_source.html#l00202">TMC2208.cpp:202</a></div></div>
<div class="ttc" id="aclassTmc2208_html_a11d520e001e90c89c6dc2f4fa9cf2d09"><div class="ttname"><a href="classTmc2208.html#a11d520e001e90c89c6dc2f4fa9cf2d09">Tmc2208::holdCurrent</a></div><div class="ttdeci">uint8_t holdCurrent</div><div class="ttdef"><b>Definition:</b> <a href="TMC2208_8h_source.html#l00376">TMC2208.h:376</a></div></div>
<div class="ttc" id="aclassTmc2208_html"><div class="ttname"><a href="classTmc2208.html">Tmc2208</a></div><div class="ttdoc">Prototype of class for accessing all features of the TMC2208 in a single object.</div><div class="ttdef"><b>Definition:</b> <a href="TMC2208_8h_source.html#l00277">TMC2208.h:278</a></div></div>
<div class="ttc" id="aclassTmc2208_html_aee6f58d366f4603b73629dc04d53400a"><div class="ttname"><a href="classTmc2208.html#aee6f58d366f4603b73629dc04d53400a">Tmc2208::Tmc2208</a></div><div class="ttdeci">Tmc2208(void)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="TMC2208_8cpp_source.html#l00109">TMC2208.cpp:109</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jun 14 2020 14:01:45 for uStepper S-lite by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
